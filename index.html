<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyper Idle Clicker Evolution | Juego Incremental</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7c3aed;
            --secondary: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f1f5f9;
            --premium: #fbbf24;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, var(--darker), #1e1b4b);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header con estad√≠sticas */
        .header {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            background: rgba(30, 41, 59, 0.8);
            padding: 20px;
            border-radius: 20px;
            border: 2px solid var(--primary);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(245, 158, 11, 0.1));
            padding: 15px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--premium);
            text-shadow: 0 0 10px currentColor;
        }
        
        .stat-subvalue {
            font-size: 0.9rem;
            color: #cbd5e1;
            margin-top: 5px;
        }
        
        /* √Årea principal del juego */
        .game-area {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1024px) {
            .game-area {
                grid-template-columns: 1fr;
            }
        }
        
        /* Clicker principal */
        .clicker-section {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border: 2px solid var(--secondary);
            position: sticky;
            top: 20px;
            height: fit-content;
        }
        
        .clicker-title {
            font-size: 1.8rem;
            color: var(--secondary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .clicker-button {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: 6px solid var(--premium);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            cursor: pointer;
            margin: 0 auto 30px;
            transition: all 0.1s;
            user-select: none;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }
        
        .clicker-button:active {
            transform: scale(0.95);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .clicker-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* Secci√≥n de generadores */
        .generators-section {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid var(--success);
        }
        
        .section-title {
            font-size: 1.5rem;
            color: var(--success);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .generator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .generator-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(30, 41, 59, 0.8));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(16, 185, 129, 0.5);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .generator-card:hover {
            transform: translateY(-5px);
            border-color: var(--success);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        
        .generator-card.disabled {
            opacity: 0.5;
            filter: grayscale(1);
            cursor: not-allowed;
        }
        
        .generator-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .generator-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--light);
        }
        
        .generator-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #94a3b8;
            margin-bottom: 15px;
        }
        
        .generator-cost {
            color: var(--premium);
            font-weight: bold;
        }
        
        .generator-level {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .generator-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .generator-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #34d399);
            width: 0%;
            transition: width 0.3s;
        }
        
        /* Upgrades */
        .upgrades-section {
            background: rgba(30, 41, 59, 0.9);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 2px solid #8b5cf6;
        }
        
        .upgrade-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .upgrade-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(30, 41, 59, 0.8));
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(139, 92, 246, 0.5);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upgrade-card:hover {
            transform: translateY(-5px);
            border-color: #8b5cf6;
        }
        
        .upgrade-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .upgrade-card.purchased {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(30, 41, 59, 0.8));
        }
        
        /* Prestigio */
        .prestige-section {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(30, 41, 59, 0.9));
            border-radius: 20px;
            padding: 30px;
            border: 2px solid var(--secondary);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .prestige-button {
            background: linear-gradient(135deg, var(--secondary), #f97316);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px auto;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .prestige-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 15px 30px rgba(245, 158, 11, 0.4);
        }
        
        .prestige-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .prestige-bonus {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        /* Evoluciones */
        .evolution-section {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(30, 41, 59, 0.9));
            border-radius: 20px;
            padding: 30px;
            border: 2px solid var(--danger);
            margin-bottom: 30px;
        }
        
        .evolution-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        
        .evolution-tab {
            background: rgba(239, 68, 68, 0.2);
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .evolution-tab.active {
            background: var(--danger);
            font-weight: bold;
        }
        
        .evolution-content {
            display: none;
        }
        
        .evolution-content.active {
            display: block;
        }
        
        /* Tienda */
        .shop-section {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(30, 41, 59, 0.9));
            border-radius: 20px;
            padding: 25px;
            border: 2px solid var(--premium);
        }
        
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .shop-item {
            background: rgba(251, 191, 36, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .shop-item:hover {
            border-color: var(--premium);
            transform: translateY(-5px);
        }
        
        .shop-item-cost {
            color: var(--premium);
            font-weight: bold;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        
        /* Modales */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--dark);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            border: 3px solid var(--primary);
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* Notificaciones */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1001;
            display: none;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        /* Efectos de part√≠culas */
        .particle {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            opacity: 0.7;
            z-index: 1;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .clicker-button {
                width: 200px;
                height: 200px;
                font-size: 3rem;
            }
            
            .generator-grid, .upgrade-grid, .shop-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Animaciones */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Scroll personalizado */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--darker);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 5px;
        }
        
        /* Progreso global */
        .global-progress {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .global-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 1s;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header con estad√≠sticas -->
        <div class="header">
            <div class="stat-card">
                <div class="stat-label">üí∞ Dinero Total</div>
                <div class="stat-value" id="totalMoney">0</div>
                <div class="stat-subvalue" id="moneyPerSecond">+0/s</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">‚ö° Clic por Click</div>
                <div class="stat-value" id="clickPower">1</div>
                <div class="stat-subvalue">Nivel <span id="clickLevel">1</span></div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üåü Prestigio</div>
                <div class="stat-value" id="prestigeLevel">0</div>
                <div class="stat-subvalue" id="prestigeMultiplier">x1.00</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">üíé Gemas</div>
                <div class="stat-value" id="gems">0</div>
                <div class="stat-subvalue">Premium currency</div>
            </div>
        </div>
        
        <!-- Progreso global -->
        <div class="global-progress">
            <div class="global-progress-bar" id="globalProgressBar"></div>
        </div>
        
        <!-- √Årea principal del juego -->
        <div class="game-area">
            <!-- Clicker principal -->
            <div class="clicker-section">
                <h2 class="clicker-title">
                    <i class="fas fa-hand-pointer"></i> CLICKER PRINCIPAL
                </h2>
                
                <div class="clicker-button" id="clickerButton">
                    <i class="fas fa-coins"></i>
                </div>
                
                <div class="clicker-stats">
                    <div>
                        <div class="stat-label">Total Clicks</div>
                        <div class="stat-value" id="totalClicks">0</div>
                    </div>
                    <div>
                        <div class="stat-label">CPS Manual</div>
                        <div class="stat-value" id="manualCPS">0</div>
                    </div>
                </div>
                
                <button class="prestige-button" id="upgradeClicker">
                    <i class="fas fa-arrow-up"></i>
                    Mejorar Click (Coste: <span id="clickUpgradeCost">10</span>)
                </button>
            </div>
            
            <!-- Generadores -->
            <div class="generators-section">
                <h2 class="section-title">
                    <i class="fas fa-industry"></i> GENERADORES AUTOM√ÅTICOS
                </h2>
                
                <div class="generator-grid" id="generatorGrid">
                    <!-- Los generadores se insertar√°n aqu√≠ -->
                </div>
            </div>
        </div>
        
        <!-- Upgrades -->
        <div class="upgrades-section">
            <h2 class="section-title">
                <i class="fas fa-bolt"></i> MEJORAS ESPECIALES
            </h2>
            
            <div class="upgrade-grid" id="upgradeGrid">
                <!-- Las mejoras se insertar√°n aqu√≠ -->
            </div>
        </div>
        
        <!-- Prestigio -->
        <div class="prestige-section">
            <h2 class="section-title">
                <i class="fas fa-crown"></i> SISTEMA DE PRESTIGIO
            </h2>
            
            <p>Reinicia tu progreso a cambio de un multiplicador permanente.</p>
            
            <div class="prestige-bonus">
                <p>Pr√≥ximo multiplicador: <span id="nextPrestigeMultiplier">x1.50</span></p>
                <p>Requisito: <span id="prestigeRequirement">1,000,000</span> dinero total</p>
            </div>
            
            <button class="prestige-button" id="prestigeButton" disabled>
                <i class="fas fa-redo"></i>
                PRESTIGE (Reiniciar juego)
            </button>
        </div>
        
        <!-- Evoluciones -->
        <div class="evolution-section">
            <h2 class="section-title">
                <i class="fas fa-atom"></i> EVOLUCIONES
            </h2>
            
            <div class="evolution-tabs" id="evolutionTabs">
                <!-- Las pesta√±as de evoluci√≥n se insertar√°n aqu√≠ -->
            </div>
            
            <div class="evolution-content active" id="evolutionContent1">
                <!-- Contenido de evoluci√≥n -->
                <p>Desbloquea nuevas mec√°nicas y potenciadores.</p>
                <div id="evolutionItems">
                    <!-- Items de evoluci√≥n -->
                </div>
            </div>
        </div>
        
        <!-- Tienda -->
        <div class="shop-section">
            <h2 class="section-title">
                <i class="fas fa-shopping-cart"></i> TIENDA PREMIUM
            </h2>
            
            <div class="shop-grid" id="shopGrid">
                <!-- Items de la tienda -->
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmaci√≥n -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <button class="modal-close" id="closeModal">&times;</button>
            <h2 id="modalTitle">Confirmar acci√≥n</h2>
            <p id="modalMessage">¬øEst√°s seguro?</p>
            <div style="display: flex; gap: 15px; margin-top: 20px;">
                <button class="prestige-button" id="modalConfirm">Confirmar</button>
                <button class="prestige-button" style="background: var(--danger);" id="modalCancel">Cancelar</button>
            </div>
        </div>
    </div>
    
    <!-- Notificaciones -->
    <div class="notification" id="notification"></div>

    <script>
        // ============================
        // VARIABLES Y ESTADO DEL JUEGO
        // ============================
        const gameState = {
            // Recursos principales
            money: 0,
            totalMoney: 0,
            gems: 100,
            prestigeLevel: 0,
            prestigeMultiplier: 1,
            
            // Estad√≠sticas
            clicks: 0,
            clickPower: 1,
            clickUpgradeCost: 10,
            clickLevel: 1,
            
            // Generadores
            generators: [
                {
                    id: 'generator1',
                    name: 'Miner√≠a B√°sica',
                    icon: '‚õèÔ∏è',
                    baseCost: 15,
                    baseProduction: 0.1,
                    level: 0,
                    unlocked: true,
                    description: 'Extrae recursos b√°sicos'
                },
                {
                    id: 'generator2',
                    name: 'Granja Automatizada',
                    icon: 'üåæ',
                    baseCost: 100,
                    baseProduction: 1,
                    level: 0,
                    unlocked: false,
                    description: 'Produce alimentos automatizados'
                },
                {
                    id: 'generator3',
                    name: 'F√°brica de Robots',
                    icon: 'ü§ñ',
                    baseCost: 500,
                    baseProduction: 5,
                    level: 0,
                    unlocked: false,
                    description: 'Fabrica robots trabajadores'
                },
                {
                    id: 'generator4',
                    name: 'Planta de Energ√≠a',
                    icon: '‚ö°',
                    baseCost: 3000,
                    baseProduction: 25,
                    level: 0,
                    unlocked: false,
                    description: 'Genera energ√≠a para todo'
                },
                {
                    id: 'generator5',
                    name: 'Centro de Investigaci√≥n',
                    icon: 'üî¨',
                    baseCost: 10000,
                    baseProduction: 100,
                    level: 0,
                    unlocked: false,
                    description: 'Investiga nuevas tecnolog√≠as'
                },
                {
                    id: 'generator6',
                    name: 'Colonia Espacial',
                    icon: 'üöÄ',
                    baseCost: 50000,
                    baseProduction: 500,
                    level: 0,
                    unlocked: false,
                    description: 'Expansi√≥n interplanetaria'
                },
                {
                    id: 'generator7',
                    name: 'Portal Cu√°ntico',
                    icon: 'üåÄ',
                    baseCost: 250000,
                    baseProduction: 2500,
                    level: 0,
                    unlocked: false,
                    description: 'Manipula la realidad'
                },
                {
                    id: 'generator8',
                    name: 'Singularidad',
                    icon: '‚≠ê',
                    baseCost: 1000000,
                    baseProduction: 10000,
                    level: 0,
                    unlocked: false,
                    description: 'Control de energ√≠a c√≥smica'
                }
            ],
            
            // Mejoras
            upgrades: [
                {
                    id: 'upgrade1',
                    name: 'Click Doble',
                    icon: '‚úåÔ∏è',
                    cost: 50,
                    description: 'Doble poder de click',
                    purchased: false,
                    effect: 'multiplyClickPower',
                    value: 2
                },
                {
                    id: 'upgrade2',
                    name: 'Auto-Clicker',
                    icon: 'ü§ñ',
                    cost: 200,
                    description: '1 click autom√°tico por segundo',
                    purchased: false,
                    effect: 'autoClicker',
                    value: 1
                },
                {
                    id: 'upgrade3',
                    name: 'Generadores x2',
                    icon: 'üìà',
                    cost: 1000,
                    description: 'Generadores producen el doble',
                    purchased: false,
                    effect: 'generatorMultiplier',
                    value: 2
                },
                {
                    id: 'upgrade4',
                    name: 'Tiempo Acelerado',
                    icon: '‚è©',
                    cost: 5000,
                    description: 'Los generadores son 50% m√°s r√°pidos',
                    purchased: false,
                    effect: 'generatorSpeed',
                    value: 1.5
                }
            ],
            
            // Evoluciones
            evolutions: [
                {
                    id: 'evo1',
                    name: 'Automatizaci√≥n Total',
                    icon: 'üè≠',
                    cost: 10000,
                    description: 'Desbloquea mejoras de automatizaci√≥n',
                    unlocked: false,
                    effect: 'unlockAutomation'
                },
                {
                    id: 'evo2',
                    name: 'Realidad Virtual',
                    icon: 'üëì',
                    cost: 50000,
                    description: 'Desbloquea la dimensi√≥n virtual',
                    unlocked: false,
                    effect: 'unlockVR'
                },
                {
                    id: 'evo3',
                    name: 'Inteligencia Artificial',
                    icon: 'üß†',
                    cost: 250000,
                    description: 'IA que optimiza producci√≥n',
                    unlocked: false,
                    effect: 'unlockAI'
                },
                {
                    id: 'evo4',
                    name: 'Viaje en el Tiempo',
                    icon: '‚è≥',
                    cost: 1000000,
                    description: 'Manipula el flujo del tiempo',
                    unlocked: false,
                    effect: 'unlockTimeTravel'
                }
            ],
            
            // Tienda
            shopItems: [
                {
                    id: 'shop1',
                    name: '+1000 Dinero',
                    icon: 'üí∞',
                    cost: 10,
                    description: 'Instant boost',
                    effect: 'addMoney',
                    value: 1000
                },
                {
                    id: 'shop2',
                    name: 'x2 Boost 1h',
                    icon: '‚ö°',
                    cost: 25,
                    description: 'Todo x2 por 1 hora',
                    effect: 'temporaryMultiplier',
                    value: 2,
                    duration: 3600000
                },
                {
                    id: 'shop3',
                    name: 'Auto-Clicker Premium',
                    icon: 'üëë',
                    cost: 50,
                    description: '+10 clicks autom√°ticos por segundo',
                    effect: 'premiumAutoClicker',
                    value: 10
                },
                {
                    id: 'shop4',
                    name: 'Paquete de Inicio',
                    icon: 'üéÅ',
                    cost: 100,
                    description: 'Mejoras iniciales + gemas extra',
                    effect: 'starterPack'
                }
            ],
            
            // Prestigio
            nextPrestigeMultiplier: 1.5,
            prestigeRequirement: 1000000,
            
            // Efectos activos
            activeBoosts: [],
            
            // Sistema de guardado
            lastSave: Date.now(),
            saveInterval: 30000 // 30 segundos
        };

        // ============================
        // FUNCIONES DE INICIALIZACI√ìN
        // ============================
        function initGame() {
            loadGame();
            createGenerators();
            createUpgrades();
            createEvolutions();
            createShopItems();
            updateUI();
            setupEventListeners();
            startGameLoop();
            startAutoSave();
            
            showNotification('¬°Bienvenido a Hyper Idle Clicker Evolution!', 'success');
        }

        function createGenerators() {
            const generatorGrid = document.getElementById('generatorGrid');
            generatorGrid.innerHTML = '';
            
            gameState.generators.forEach(generator => {
                const generatorCard = document.createElement('div');
                generatorCard.className = `generator-card ${generator.level === 0 && generator.unlocked ? '' : 'disabled'}`;
                generatorCard.id = generator.id;
                
                const cost = Math.floor(generator.baseCost * Math.pow(1.15, generator.level));
                const production = generator.baseProduction * generator.level * gameState.prestigeMultiplier;
                
                generatorCard.innerHTML = `
                    <div class="generator-icon">${generator.icon}</div>
                    <div class="generator-name">${generator.name}</div>
                    <div class="generator-stats">
                        <span>Nivel: ${generator.level}</span>
                        <span class="generator-cost">${formatNumber(cost)}</span>
                    </div>
                    <div class="generator-stats">
                        <span>Producci√≥n: ${formatNumber(production)}/s</span>
                    </div>
                    <div class="generator-progress">
                        <div class="generator-progress-bar" id="progress-${generator.id}"></div>
                    </div>
                    <div class="generator-level">${generator.level}</div>
                `;
                
                if (generator.unlocked || generator.level > 0) {
                    generatorCard.addEventListener('click', () => buyGenerator(generator.id));
                }
                
                generatorGrid.appendChild(generatorCard);
            });
        }

        function createUpgrades() {
            const upgradeGrid = document.getElementById('upgradeGrid');
            upgradeGrid.innerHTML = '';
            
            gameState.upgrades.forEach(upgrade => {
                const upgradeCard = document.createElement('div');
                upgradeCard.className = `upgrade-card ${upgrade.purchased ? 'purchased' : ''} ${gameState.money >= upgrade.cost ? '' : 'disabled'}`;
                upgradeCard.id = upgrade.id;
                
                upgradeCard.innerHTML = `
                    <div style="font-size: 2rem; margin-bottom: 10px;">${upgrade.icon}</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">${upgrade.name}</div>
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">${upgrade.description}</div>
                    <div style="color: var(--premium); font-weight: bold; margin-top: 10px;">${formatNumber(upgrade.cost)}</div>
                `;
                
                if (!upgrade.purchased) {
                    upgradeCard.addEventListener('click', () => buyUpgrade(upgrade.id));
                }
                
                upgradeGrid.appendChild(upgradeCard);
            });
        }

        function createEvolutions() {
            const evolutionTabs = document.getElementById('evolutionTabs');
            evolutionTabs.innerHTML = '';
            
            gameState.evolutions.forEach((evolution, index) => {
                const tab = document.createElement('div');
                tab.className = `evolution-tab ${index === 0 ? 'active' : ''}`;
                tab.textContent = evolution.name;
                tab.addEventListener('click', () => switchEvolutionTab(index));
                evolutionTabs.appendChild(tab);
            });
            
            updateEvolutionContent();
        }

        function createShopItems() {
            const shopGrid = document.getElementById('shopGrid');
            shopGrid.innerHTML = '';
            
            gameState.shopItems.forEach(item => {
                const shopItem = document.createElement('div');
                shopItem.className = 'shop-item';
                shopItem.id = item.id;
                
                shopItem.innerHTML = `
                    <div style="font-size: 2.5rem; margin-bottom: 10px;">${item.icon}</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">${item.name}</div>
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">${item.description}</div>
                    <div class="shop-item-cost">${item.cost} üíé</div>
                `;
                
                shopItem.addEventListener('click', () => buyShopItem(item.id));
                
                shopGrid.appendChild(shopItem);
            });
        }

        // ============================
        // FUNCIONES DEL JUEGO
        // ============================
        function click() {
            const baseClick = gameState.clickPower * gameState.prestigeMultiplier;
            const clickBoost = gameState.activeBoosts.find(b => b.type === 'click')?.value || 1;
            const clickAmount = baseClick * clickBoost;
            
            gameState.money += clickAmount;
            gameState.totalMoney += clickAmount;
            gameState.clicks++;
            
            // Efecto visual
            createParticle(event.clientX, event.clientY, clickAmount);
            
            updateUI();
        }

        function buyGenerator(generatorId) {
            const generator = gameState.generators.find(g => g.id === generatorId);
            const cost = Math.floor(generator.baseCost * Math.pow(1.15, generator.level));
            
            if (gameState.money >= cost && (generator.unlocked || generator.level > 0)) {
                gameState.money -= cost;
                generator.level++;
                
                // Desbloquear siguiente generador si corresponde
                if (generator.level === 1) {
                    const nextIndex = gameState.generators.findIndex(g => g.id === generatorId) + 1;
                    if (nextIndex < gameState.generators.length) {
                        gameState.generators[nextIndex].unlocked = true;
                    }
                }
                
                updateUI();
                createGenerators();
                showNotification(`¬°${generator.name} mejorado a nivel ${generator.level}!`, 'success');
            }
        }

        function buyUpgrade(upgradeId) {
            const upgrade = gameState.upgrades.find(u => u.id === upgradeId);
            
            if (!upgrade.purchased && gameState.money >= upgrade.cost) {
                gameState.money -= upgrade.cost;
                upgrade.purchased = true;
                
                // Aplicar efecto
                applyUpgradeEffect(upgrade);
                
                updateUI();
                createUpgrades();
                showNotification(`¬°${upgrade.name} desbloqueada!`, 'success');
            }
        }

        function applyUpgradeEffect(upgrade) {
            switch(upgrade.effect) {
                case 'multiplyClickPower':
                    gameState.clickPower *= upgrade.value;
                    break;
                case 'autoClicker':
                    // Agregar auto-clicks
                    startAutoClicker(upgrade.value);
                    break;
                case 'generatorMultiplier':
                    // Ya se aplica en calculateProduction()
                    break;
                case 'generatorSpeed':
                    // Ya se aplica en calculateProduction()
                    break;
            }
        }

        function buyShopItem(itemId) {
            const item = gameState.shopItems.find(i => i.id === itemId);
            
            if (gameState.gems >= item.cost) {
                gameState.gems -= item.cost;
                
                // Aplicar efecto
                applyShopItemEffect(item);
                
                updateUI();
                showNotification(`¬°${item.name} comprado!`, 'premium');
            }
        }

        function applyShopItemEffect(item) {
            switch(item.effect) {
                case 'addMoney':
                    gameState.money += item.value;
                    gameState.totalMoney += item.value;
                    break;
                case 'temporaryMultiplier':
                    gameState.activeBoosts.push({
                        type: 'global',
                        value: item.value,
                        expires: Date.now() + item.duration
                    });
                    break;
                case 'premiumAutoClicker':
                    startAutoClicker(item.value);
                    break;
                case 'starterPack':
                    gameState.money += 10000;
                    gameState.gems += 50;
                    gameState.clickPower *= 2;
                    break;
            }
        }

        function prestige() {
            if (gameState.totalMoney >= gameState.prestigeRequirement) {
                showConfirmModal(
                    '¬øPrestigiar?',
                    `Reiniciar√°s todo por un multiplicador x${gameState.nextPrestigeMultiplier}`,
                    () => {
                        // Guardar estad√≠sticas previas
                        const oldPrestige = gameState.prestigeLevel;
                        const oldMultiplier = gameState.prestigeMultiplier;
                        
                        // Aplicar prestigio
                        gameState.prestigeLevel++;
                        gameState.prestigeMultiplier *= gameState.nextPrestigeMultiplier;
                        
                        // Reiniciar juego
                        gameState.money = 0;
                        gameState.clicks = 0;
                        gameState.clickPower = 1;
                        gameState.clickLevel = 1;
                        gameState.clickUpgradeCost = 10;
                        
                        gameState.generators.forEach(g => {
                            g.level = 0;
                            g.unlocked = g.id === 'generator1';
                        });
                        
                        gameState.upgrades.forEach(u => {
                            u.purchased = false;
                        });
                        
                        gameState.evolutions.forEach(e => {
                            e.unlocked = false;
                        });
                        
                        // Actualizar requisito de pr√≥ximo prestigio
                        gameState.prestigeRequirement *= 10;
                        gameState.nextPrestigeMultiplier += 0.5;
                        
                        // Actualizar UI
                        updateUI();
                        createGenerators();
                        createUpgrades();
                        
                        showNotification(`¬°Prestigio ${gameState.prestigeLevel} alcanzado! Multiplicador: x${gameState.prestigeMultiplier.toFixed(2)}`, 'premium');
                    }
                );
            }
        }

        function upgradeClicker() {
            const cost = gameState.clickUpgradeCost;
            
            if (gameState.money >= cost) {
                gameState.money -= cost;
                gameState.clickPower = Math.floor(gameState.clickPower * 1.5);
                gameState.clickLevel++;
                gameState.clickUpgradeCost = Math.floor(cost * 2.5);
                
                updateUI();
                showNotification(`¬°Click mejorado a nivel ${gameState.clickLevel}!`, 'success');
            }
        }

        // ============================
        // C√ÅLCULOS Y ACTUALIZACIONES
        // ============================
        function calculateProduction() {
            let totalProduction = 0;
            let generatorMultiplier = 1;
            let speedMultiplier = 1;
            
            // Aplicar mejoras
            gameState.upgrades.forEach(upgrade => {
                if (upgrade.purchased) {
                    if (upgrade.effect === 'generatorMultiplier') {
                        generatorMultiplier *= upgrade.value;
                    }
                    if (upgrade.effect === 'generatorSpeed') {
                        speedMultiplier *= upgrade.value;
                    }
                }
            });
            
            // Calcular producci√≥n de cada generador
            gameState.generators.forEach(generator => {
                if (generator.level > 0) {
                    const production = generator.baseProduction * generator.level * 
                                     gameState.prestigeMultiplier * generatorMultiplier;
                    totalProduction += production * speedMultiplier;
                }
            });
            
            return totalProduction;
        }

        function updateUI() {
            // Actualizar dinero
            document.getElementById('totalMoney').textContent = formatNumber(gameState.money);
            document.getElementById('totalMoney').style.animation = 'pulse 0.5s';
            
            // Actualizar producci√≥n por segundo
            const production = calculateProduction();
            document.getElementById('moneyPerSecond').textContent = `+${formatNumber(production)}/s`;
            
            // Actualizar estad√≠sticas de click
            document.getElementById('clickPower').textContent = formatNumber(gameState.clickPower);
            document.getElementById('clickLevel').textContent = gameState.clickLevel;
            document.getElementById('clickUpgradeCost').textContent = formatNumber(gameState.clickUpgradeCost);
            
            // Actualizar estad√≠sticas generales
            document.getElementById('totalClicks').textContent = formatNumber(gameState.clicks);
            document.getElementById('manualCPS').textContent = formatNumber(gameState.clickPower * 10); // Estimado
            
            // Actualizar prestigio
            document.getElementById('prestigeLevel').textContent = gameState.prestigeLevel;
            document.getElementById('prestigeMultiplier').textContent = `x${gameState.prestigeMultiplier.toFixed(2)}`;
            document.getElementById('nextPrestigeMultiplier').textContent = `x${gameState.nextPrestigeMultiplier.toFixed(2)}`;
            document.getElementById('prestigeRequirement').textContent = formatNumber(gameState.prestigeRequirement);
            
            // Actualizar gemas
            document.getElementById('gems').textContent = gameState.gems;
            
            // Actualizar barra de progreso global
            const progressPercent = Math.min((gameState.totalMoney / gameState.prestigeRequirement) * 100, 100);
            document.getElementById('globalProgressBar').style.width = `${progressPercent}%`;
            
            // Habilitar/deshabilitar bot√≥n de prestigio
            document.getElementById('prestigeButton').disabled = gameState.totalMoney < gameState.prestigeRequirement;
            
            // Remover animaci√≥n despu√©s de completar
            setTimeout(() => {
                document.getElementById('totalMoney').style.animation = '';
            }, 500);
        }

        function updateEvolutionContent() {
            const evolutionItems = document.getElementById('evolutionItems');
            evolutionItems.innerHTML = '';
            
            gameState.evolutions.forEach(evolution => {
                const evolutionItem = document.createElement('div');
                evolutionItem.className = 'upgrade-card';
                evolutionItem.innerHTML = `
                    <div style="font-size: 2rem; margin-bottom: 10px;">${evolution.icon}</div>
                    <div style="font-weight: bold; margin-bottom: 5px;">${evolution.name}</div>
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">${evolution.description}</div>
                    <div style="color: var(--premium); font-weight: bold; margin-top: 10px;">${formatNumber(evolution.cost)}</div>
                `;
                
                if (!evolution.unlocked) {
                    evolutionItem.addEventListener('click', () => buyEvolution(evolution.id));
                }
                
                evolutionItems.appendChild(evolutionItem);
            });
        }

        function buyEvolution(evolutionId) {
            const evolution = gameState.evolutions.find(e => e.id === evolutionId);
            
            if (!evolution.unlocked && gameState.money >= evolution.cost) {
                gameState.money -= evolution.cost;
                evolution.unlocked = true;
                
                applyEvolutionEffect(evolution);
                updateEvolutionContent();
                showNotification(`¬°${evolution.name} desbloqueada!`, 'success');
            }
        }

        function applyEvolutionEffect(evolution) {
            // Aqu√≠ se aplicar√≠an efectos especiales de evoluci√≥n
            switch(evolution.effect) {
                case 'unlockAutomation':
                    // Desbloquear nuevas mec√°nicas
                    break;
                case 'unlockVR':
                    // Nueva dimensi√≥n de juego
                    break;
                case 'unlockAI':
                    // Optimizaciones autom√°ticas
                    break;
                case 'unlockTimeTravel':
                    // Manipulaci√≥n temporal
                    break;
            }
        }

        function switchEvolutionTab(index) {
            document.querySelectorAll('.evolution-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.evolution-content').forEach(content => content.classList.remove('active'));
            
            document.querySelectorAll('.evolution-tab')[index].classList.add('active');
            document.querySelectorAll('.evolution-content')[index].classList.add('active');
        }

        // ============================
        // EVENT LISTENERS
        // ============================
        function setupEventListeners() {
            // Clicker principal
            document.getElementById('clickerButton').addEventListener('click', click);
            document.getElementById('clickerButton').addEventListener('touchstart', click);
            
            // Mejorar clicker
            document.getElementById('upgradeClicker').addEventListener('click', upgradeClicker);
            
            // Prestigio
            document.getElementById('prestigeButton').addEventListener('click', prestige);
            
            // Modal
            document.getElementById('closeModal').addEventListener('click', closeModal);
            document.getElementById('modalCancel').addEventListener('click', closeModal);
            document.getElementById('modalConfirm').addEventListener('click', confirmModalAction);
            
            // Eventos de teclado
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    click();
                    e.preventDefault();
                }
            });
        }

        // ============================
        // EFECTOS VISUALES
        // ============================
        function createParticle(x, y, amount) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.textContent = `+${formatNumber(amount)}`;
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.color = '#fbbf24';
            particle.style.fontWeight = 'bold';
            particle.style.fontSize = '16px';
            particle.style.pointerEvents = 'none';
            
            document.body.appendChild(particle);
            
            // Animaci√≥n
            const duration = 1000;
            const startY = y;
            const endY = startY - 100;
            const startTime = Date.now();
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const currentY = startY - (progress * 100);
                const opacity = 1 - progress;
                
                particle.style.top = currentY + 'px';
                particle.style.opacity = opacity;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    particle.remove();
                }
            }
            
            animate();
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // Colores seg√∫n tipo
            switch(type) {
                case 'success':
                    notification.style.background = 'var(--success)';
                    break;
                case 'error':
                    notification.style.background = 'var(--danger)';
                    break;
                case 'premium':
                    notification.style.background = 'var(--premium)';
                    break;
                default:
                    notification.style.background = 'var(--primary)';
            }
            
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ============================
        // MODAL DE CONFIRMACI√ìN
        // ============================
        let currentModalAction = null;

        function showConfirmModal(title, message, action) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            currentModalAction = action;
            document.getElementById('confirmModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('confirmModal').classList.remove('active');
            currentModalAction = null;
        }

        function confirmModalAction() {
            if (currentModalAction) {
                currentModalAction();
            }
            closeModal();
        }

        // ============================
        // AUTO-CLICKERS Y BUCLE
        // ============================
        let autoClickers = [];

        function startAutoClicker(cps) {
            autoClickers.push({
                interval: setInterval(() => {
                    gameState.money += gameState.clickPower * gameState.prestigeMultiplier;
                    gameState.totalMoney += gameState.clickPower * gameState.prestigeMultiplier;
                    updateUI();
                }, 1000 / cps),
                cps: cps
            });
            
            showNotification(`Auto-clicker activado (+${cps} CPS)`, 'success');
        }

        function startGameLoop() {
            setInterval(() => {
                // Producci√≥n autom√°tica
                const production = calculateProduction();
                gameState.money += production / 10; // Actualizar 10 veces por segundo
                gameState.totalMoney += production / 10;
                
                // Actualizar barras de progreso de generadores
                updateGeneratorProgressBars();
                
                // Actualizar UI
                updateUI();
                
                // Limpiar boosts expirados
                cleanupExpiredBoosts();
                
            }, 100);
        }

        function updateGeneratorProgressBars() {
            gameState.generators.forEach(generator => {
                const progressBar = document.getElementById(`progress-${generator.id}`);
                if (progressBar) {
                    // Simular progreso de generaci√≥n
                    progressBar.style.width = `${(Date.now() / 1000) % 100}%`;
                }
            });
        }

        function cleanupExpiredBoosts() {
            const now = Date.now();
            gameState.activeBoosts = gameState.activeBoosts.filter(boost => boost.expires > now);
        }

        // ============================
        // SISTEMA DE GUARDADO
        // ============================
        function saveGame() {
            const saveData = {
                ...gameState,
                lastSave: Date.now(),
                autoClickers: [] // No guardar intervalos
            };
            
            localStorage.setItem('hyperIdleClickerSave', JSON.stringify(saveData));
        }

        function loadGame() {
            const saved = localStorage.getItem('hyperIdleClickerSave');
            if (saved) {
                const loadedData = JSON.parse(saved);
                
                // Cargar datos preservando funciones y referencias
                Object.keys(gameState).forEach(key => {
                    if (loadedData[key] !== undefined) {
                        gameState[key] = loadedData[key];
                    }
                });
                
                gameState.lastSave = Date.now();
                showNotification('Partida cargada exitosamente', 'success');
            }
        }

        function startAutoSave() {
            setInterval(saveGame, gameState.saveInterval);
        }

        // ============================
        // UTILIDADES
        // ============================
        function formatNumber(num) {
            if (num >= 1e12) return (num / 1e12).toFixed(2) + 'T';
            if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
            return Math.floor(num).toString();
        }

        // ============================
        // INICIAR EL JUEGO
        // ============================
        document.addEventListener('DOMContentLoaded', initGame);

        // Guardar antes de cerrar
        window.addEventListener('beforeunload', saveGame);
    </script>
</body>
</html>